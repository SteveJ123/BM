define(["require","exports","tslib","react","spectrum/button","spectrum/tertiary_link","spectrum/modal","modules/clean/ajax","modules/clean/teams/constants","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/contacts/contact","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/dbmodal_stack","react-modal","modules/clean/loggers/join_flow_logger","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/payments/skus/subscription_status","modules/clean/teams/admin/widgets/update_billing_modal/update_billing_modal_loader","modules/clean/react/css","modules/clean/react/invite/invite_and_buy_text","modules/clean/react/modal","modules/clean/stormcrow/experiment","modules/clean/viewer","modules/core/browser","modules/core/browser_detection","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/user_education/user_education_client","external/lodash","modules/clean/ux_analytics_modal_tracking","modules/clean/ux_analytics_utils","modules/clean/react/payments/common/adapters/setup_cash","modules/clean/teams/admin/widgets/invite_modal/invite_link","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task","modules/clean/teams/admin/widgets/invite_modal/invite_modal_groups","modules/clean/react/member_sidebar_actions","modules/clean/teams/admin/widgets/invite_modal/invite_modal_member_data","modules/clean/react/table","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/react/admin/teams/onboarding/web/constants"],(function(e,t,i,n,s,a,o,r,l,m,u,c,d,g,v,p,_,f,b,h,M,S,L,I,y,A,k,E,w,T,C,x,N,P,O,R,D,F,B,V,W,G,j,z,U,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=i.__importDefault(n),r=i.__importStar(r),g=i.__importDefault(g),p=i.__importDefault(p),E=i.__importStar(E),w=i.__importStar(w),P=i.__importStar(P),B=i.__importDefault(B),p.default.setAppElement(document.body);var Y=(function(e){function a(a){var o=e.call(this,a)||this;return o.closeModal=function(e){var t=o.props.onDismiss;window.setTimeout((function(){N.UEClient.sendEvent("InviteModal","Hide")}),2500),t?null==t||t(o.state.memberList):y.Modal.close(),e&&e(o.state.memberList)},o.onBillingClick=function(e){e.stopPropagation(),e.preventDefault();var s=o.state,a=s.emails,r=s.inviteMessage,l=function(){y.Modal.showInstance(n.default.createElement(t.InviteModal,i.__assign({},o.props,{emails:a,inviteMessage:r}))),v.DBModalStack.unregister(f.BILLING_INFO_UPDATED,l)};o.closeModal(),v.DBModalStack.register(f.BILLING_INFO_UPDATED,l),S.UpdateBillingModalLoader.showInstance(l)},o.onSubServiceResponse=function(e,t,i,n){o.setState({emails:t,isMakingTransitionInfoRequest:!1,isPreparingForSubmit:!1,numRemainingLicenses:i-n-t.length,subChangePlan:e})},o.onContactsChanged=function(e,t){var i=o.state,n=i.isReseller,s=i.isSelfServe,a=i.numProvisionedLicenses,r=i.isLoading,l=i.emails,m=i.sentEmails;if(!r){o.setState({isEmailTextInputted:e.length>0||t.length>0});var u=e.map((function(e){return e.email})).filter((function(e){return void 0!==e})),c={emails:u,isPreparingForSubmit:!1,numRemainingLicenses:o.totalLicenses-a-u.length-m.length};!n&&s&&u.length!==l.length&&u.length+a>o.totalLicenses?o.updateSubChangePlan(u.length+a,c):o.setState(c)}},o.onMessageChanged=function(e){o.setState({inviteMessage:e.target.value})},o.sendInviteAction=function(){var e=o.state.emails,t=o.contactsTokenizer.getContacts();e.length!==t.length?o.setState({isPreparingForSubmit:!0},(function(){o.contactsTokenizer.tokenizeAll()})):o.sendMemberInvites()},o.onPrimaryActionClick=function(){!o.props.isInviteLinkGaEnabled||o.growthActSmbFirstTask.isActive?o.sendInviteAction():o.shouldRenderSendInviteAction?o.sendInviteAction():o.closeModal()},o.onSecondaryActionClick=function(){m.TeamsWebActionsLogger.log("invite_member_open_cancel",i.__assign(i.__assign({},o.defaultLoggingExtras),{added_message:o.hasInviteMessage,invite_count:o.inviteCount,invite_or_buy:o.inviteOrBuyText})),o.closeModal()},o.sendMemberInvites=function(){var e=o.state,t=e.emails,n=e.groupIds,s=e.inviteMessage,a=e.numRemainingLicenses,u=e.subChangePlan,c=e.sentEmails,d=e.memberList,g=a<0?-1*a:0,v={charge_for_new_licenses:!0,custom_message:s,emails:t,groups:n,expected_overage:String(g),expected_price:"0",extra:JSON.stringify(i.__assign({},o.defaultLoggingExtras)),url:E.get_uri().path,invite_source:_.InviteSource.IMM_WEB,platform:_.Platform.WEB};if(u&&u.tvm&&(v.expected_price=u.tvm.transition.expected_price),m.TeamsWebActionsLogger.log("invite_member_open_invite_click",i.__assign(i.__assign({},o.defaultLoggingExtras),{added_message:o.hasInviteMessage,expected_price:v.expected_price,invite_count:o.inviteCount,invite_or_buy:o.inviteOrBuyText,licenses_to_add:g})),0===t.length)return x.Notify.error(C.intl.formatMessage({id:"E/vNT2",defaultMessage:"You haven’t included anyone to invite! Please invite at least one person."})),void m.TeamsWebActionsLogger.log("invite_member_open_invite_error",i.__assign(i.__assign({},o.defaultLoggingExtras),{client:!0,error_reason:"no_invites",invite_or_buy:o.inviteOrBuyText}));for(var p=0,f=t;p<f.length;p++){var b=f[p].toLowerCase().split("@",2)[1];if(-1!==["getdropbox.com","dropboxmail.com"].indexOf(b))return x.Notify.error(C.intl.formatMessage({id:"ffW3Dm",defaultMessage:"You are not allowed to invite a member with a {domain} email."},{domain:b})),void m.TeamsWebActionsLogger.log("invite_member_open_invite_error",i.__assign(i.__assign({},o.defaultLoggingExtras),{client:!0,error_reason:"invite with dropbox domain",invite_or_buy:o.inviteOrBuyText}))}x.Notify.success(C.intl.formatMessage({id:"uBRRiV",defaultMessage:"Submitting..."})),o.setState({isSubmitting:!0},(function(){var e=Date.now(),n=k.Viewer.get_viewer().work_user;r.FormWebRequest({url:"/account/team/add_users",data:v,subject_user:n,success:function(n){var s=JSON.parse(n);if(x.Notify.clear(),o.setState({isSubmitting:!1}),m.TeamsWebActionsLogger.log("team_admin_add_member_submit_time",i.__assign(i.__assign({},o.defaultLoggingExtras),{time_ms:Date.now()-e})),s){var u=s.users,g=Object.keys(u),v=g.length,p=g.map((function(e){return u[e].email})),_=t.filter((function(e){return-1===p.indexOf(e)}));if(d.length&&(o.growthActSmbGroupsIMM.isActive||o.growthActSmbFirstTask.isActive)){var f=d[0],b=d.slice(1),h=g.map((function(e){return{admin_role:l.ADMIN_ROLE.NONE,initials:u[e].email[0].toUpperCase(),photo_url:null,display_name:u[e].email,email:u[e].email,team_join_state:G.JoinState.PENDING,user_id:u[e].id}}));o.setState({numRemainingLicenses:a-c.length,sentEmails:c.concat(h),emails:[],memberList:i.__spreadArrays([f],h,b)},(function(){U.SMBFunnelLogger.log(q.AMPMetrics.ACTIVATION_IMM_ADD_MEMBERS,{success:"true",numInvited:String(v)}),o.growthActSmbGroupsIMM.isActive?o.closeModal():o.growthActSmbFirstTask.isActive&&o.loadMemberActionsData()}))}else o.closeModal((function(){o.props.onInviteSuccess&&o.props.onInviteSuccess(s.num_invited,a<0?-1*a:0)}));m.TeamsWebActionsLogger.log("invite_member_open_invite_success",i.__assign(i.__assign({},o.defaultLoggingExtras),{added_message:o.hasInviteMessage,invite_count:o.inviteCount,invite_or_buy:o.inviteOrBuyText})),1===v?x.Notify.success(C.intl.formatMessage({id:"jHPjnH",defaultMessage:"Invited {user_email}."},{user_email:u[g[0]].email})):v>1?x.Notify.success(C.intl.formatMessage({id:"7dSNRZ",defaultMessage:"Invited {user_count} people."},{user_count:v})):x.Notify.error(C.intl.formatMessage({id:"H5ZCNq",defaultMessage:"{count, plural, one{Skipped {count} person who is already a member of the team.} other{Skipped {count} people who are already members of the team.}}"},{count:_.length})),r.SilentBackgroundRequest({url:"/account/team/ajax_log_invites",data:{invitations:v}})}else o.props.onInviteError&&o.props.onInviteError(),x.Notify.error(C.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),(o.growthActSmbGroupsIMM.isActive||o.growthActSmbFirstTask.isActive)&&U.SMBFunnelLogger.log(q.AMPMetrics.ACTIVATION_IMM_ADD_MEMBERS,{success:"false",errorReason:"response_empty"})},error:function(t,n,s){var a=C.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."});if(x.Notify.clear(),o.setState({isSubmitting:!1}),m.TeamsWebActionsLogger.log("team_admin_add_member_submit_time",i.__assign(i.__assign({},o.defaultLoggingExtras),{time_ms:Date.now()-e,error:!0})),(o.growthActSmbGroupsIMM.isActive||o.growthActSmbFirstTask.isActive)&&U.SMBFunnelLogger.log(q.AMPMetrics.ACTIVATION_IMM_ADD_MEMBERS,{success:"false",errorReason:"request_error"}),s)try{var r=JSON.parse(s).emails,l=void 0===r?{}:r;l.message_text&&(a=l.message_text,m.TeamsWebActionsLogger.log("invite_member_open_invite_error",i.__assign(i.__assign({},o.defaultLoggingExtras),{client:!0,error_reason:"form_input_invalid",invite_or_buy:o.inviteOrBuyText})))}catch(e){a=s}else m.TeamsWebActionsLogger.log("invite_member_open_invite_error",i.__assign(i.__assign({},o.defaultLoggingExtras),{client:!0,error_reason:"problem_request",invite_or_buy:o.inviteOrBuyText}));o.props.onInviteError&&o.props.onInviteError(),x.Notify.error(new T.HTML(a))}})}))},o.renderPrimaryAction=function(e,t){var i=o.state,a=i.isReseller,r=i.numRemainingLicenses,l=i.isSubmitting,m=i.isSelfServe,c=i.memberList,d=o.isInviteButtonDisabled,g=C.intl.formatMessage({id:"yzFoXG",defaultMessage:"Send invites"});return r<0&&!a&&!o.isNCCT&&m&&!c.length&&(g=C.intl.formatMessage({id:"dljqTf",defaultMessage:"Invite and buy"})),!o.props.isInviteLinkGaEnabled||o.shouldRenderSendInviteAction||o.growthActSmbFirstTask.isActive||(g=C.intl.formatMessage({id:"XEaqiT",defaultMessage:"Done"}),d=!1),n.default.createElement(s.Button,{className:"invite-modal__send-invites",ref:t,variant:"primary",disabled:d,onClick:e},n.default.createElement("span",{className:"modal-button-wrapper"},g,l&&n.default.createElement("span",{className:"loading-indicator"},n.default.createElement(u.LoadingIndicator,{style:u.LoadingIndicator.LoadingIndicatorStyle.SPINNER}))))},o.renderSecondaryAction=function(e){var t=C.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"});return n.default.createElement(s.Button,{variant:"secondary",onClick:e},t)},o.contactFilter=function(e){return e.type===g.default.EMAIL},o.renderContactsTokenizer=function(e,t,i){if(void 0===t&&(t=C.intl.formatMessage({id:"Le5Iez",defaultMessage:"Name or email"})),void 0===i&&(i=8),e){var s,a=o.state,r=a.isLoading;return s=a.emails.map((function(e){return new c.Contact({name:e,email:e,type:g.default.EMAIL,invalid:!1,on_team:!1,pending:!0,query:e})})),n.default.createElement("div",{className:"invite-modal__tokenizer"},n.default.createElement(d.ContactsTokenizer,{customClass:r?"disabled":"",customContactFilter:o.contactFilter,disabled:r,onContentsChange:o.onContactsChanged,placeholder:t,populatedInputData:{tokens:s,value:""},ref:function(e){o.contactsTokenizer=e},showContactImport:!1,tokenSpacing:i,user:e,listHeight:81,tokenizeOnOutOfFocus:!0}))}},o.closeAndOpenCSVImportModal=function(){var e=o.props,t=e.onCSVImport,i=e.onDismiss;m.TeamsWebActionsLogger.log("import_csv_modal_open",o.defaultLoggingExtras),t&&(o.closeModal(i),t())},o.subService=new h.SubscriptionService,o.apiClient=new B.default,o.state={emails:a.emails||[],groupIds:[],inviteMessage:a.inviteMessage||"",isEmailTextInputted:!!a.emails&&a.emails.length>0||!1,isLoading:!0,isMakingTransitionInfoRequest:!1,isPreparingForSubmit:!1,isSubmitting:!1,numProvisionedLicenses:0,numRemainingLicenses:0,showInviteLink:!1,showSidebar:!!a.memberList&&1===a.memberList.length&&!o.growthActSmbMWInvites.isActive,memberList:a.memberList||[],sentEmails:[]},o.growthActSmbFirstTask.isActive&&a.memberList&&o.loadMemberActionsData(),o.defaultLoggingExtras={is_client:!1,origin:o.props.origin},o.props.actionTrigger&&(o.defaultLoggingExtras.action_trigger=o.props.actionTrigger,o.defaultLoggingExtras.module_name="first_task_imm",o.defaultLoggingExtras.framework="team_setup_essential",o.defaultLoggingExtras.mobile_web=w.is_supported_mobile_browser()),o}return i.__extends(a,e),Object.defineProperty(a.prototype,"isInviteButtonDisabled",{get:function(){var e=this.state,t=e.emails,i=e.isLoading,n=e.isMakingTransitionInfoRequest,s=e.isReseller,a=e.isSelfServe,o=e.isSubmitting,r=e.numRemainingLicenses;return i||n||o||s&&r<0||!a&&r<0||0===t.length&&this.contactsTokenizer&&0===this.contactsTokenizer.getInputValue().length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hasInviteMessage",{get:function(){return Boolean(this.state.inviteMessage)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inviteCount",{get:function(){return this.state.emails.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inviteOrBuyText",{get:function(){return this.state.numRemainingLicenses<0?"invite_buy":"send_invites"},enumerable:!0,configurable:!0}),a.prototype.relaunchFirstTaskModal=function(e){var t=this.props.onDismiss;t&&t(e,!0)},a.prototype.loadMemberActionsData=function(){var e=this,t=this.props.evhMaxDays,n=this.state.memberList,s={is_current:!0,limit:n.length,offset:0,sort_column:"user_type",sort_direction:z.TableSortDir.ASC};r.WebRequest({url:"/team/admin/members/list_v2",data:s,subject_user:k.Viewer.get_viewer().work_user,success:function(s){var a=new Date((new Date).setDate(t||0)).toLocaleDateString(),o=JSON.parse(s).members,r={};o.forEach((function(t){var s=t.user_id;r[s]=i.__assign(i.__assign({},j.getMemberInviteActionsProperties(t,a)),{onClose:function(){e.relaunchFirstTaskModal(n)},deleteCallback:function(){for(var t=0;t<n.length&&n[t].user_id!==s;t++);n.splice(t,1),e.relaunchFirstTaskModal(n)},roleUpdateCallback:function(t){for(var a=0;a<n.length;a++)if(n[a].user_id===s){var o=i.__assign({},n[a]);o.admin_role=t,n[a]=o}e.setState({memberList:n})}})}),{}),e.setState({memberActionsData:r})}})},a.prototype.componentDidUpdate=function(e,t){var i=this.state,n=i.emails,s=i.isPreparingForSubmit;i.numRemainingLicenses>=n.length&&t.isPreparingForSubmit&&!s&&this.sendMemberInvites()},a.prototype.componentWillUnmount=function(){R.dispatchModalClosed()},a.prototype.componentDidMount=function(){var e=this,t=this.props.onDismiss;r.WebRequest({url:"/team/admin/members/invite_members_modal_view_model",subject_user:k.Viewer.get_viewer().work_user,success:function(t){var n,s,a=JSON.parse(t),o=a.isReseller,r=a.numActiveTeamMembers,l=a.provisionedLicenses,u=a.currencyToFormatMap,c=a.localeNumberFormat,d=void 0===a.isSelfServe||a.isSelfServe;if(o){var g=a.resellerContact,v=a.serializedResellerSubSkuSet;n=(s=v.licenseSkus[0].quantity)-l,e.setState({isLoading:!1,isReseller:o,isSelfServe:d,numActiveTeamMembers:r,numProvisionedLicenses:l,numRemainingLicenses:n,resellerContact:g,serializedResellerSubSkuSet:v},(function(){var t;e.props.shouldShowInviteLink&&(t=e.props.inviteLinkUrl?"ON":"OFF"),m.TeamsWebActionsLogger.log("invite_member_open",i.__assign(i.__assign({},e.defaultLoggingExtras),{invite_or_buy:e.inviteOrBuyText,license_limit:s,num_team_members:r,provisioned_licenses:l,url:E.get_uri().path,link_status:t})),e.setInitialSubChangePlan()}))}else{var p=M.SubscriptionStatus.deserialize(a.serializedSubStatus);n=(s=p.subState.totalLicenses)-l-e.state.emails.length-e.state.sentEmails.length,e.setState({isReseller:o,isSelfServe:d,numActiveTeamMembers:r,numProvisionedLicenses:l,numRemainingLicenses:n,subStatus:p},(function(){var t;e.props.shouldShowInviteLink&&(t=e.props.inviteLinkUrl?"ON":"OFF"),m.TeamsWebActionsLogger.log("invite_member_open",i.__assign(i.__assign({},e.defaultLoggingExtras),{invite_or_buy:e.inviteOrBuyText,license_limit:s,num_team_members:r,provisioned_licenses:l,url:E.get_uri().path,link_status:t})),e.setInitialSubChangePlan()}))}D.setupCash(c,u),R.dispatchModalOpened()},error:function(i){x.Notify.error(C.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.closeModal(t)}})},Object.defineProperty(a.prototype,"totalLicenses",{get:function(){var e=this.state,t=e.isReseller,i=e.serializedResellerSubSkuSet,n=e.subStatus;return t?i.licenseSkus[0].quantity:n?n.subState.totalLicenses:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"viewer",{get:function(){return k.Viewer.get_viewer()},enumerable:!0,configurable:!0}),a.prototype.setInitialSubChangePlan=function(){var e=this.props.emails,t=this.state.numProvisionedLicenses;if(!e)return this.setState({isLoading:!1});e.length+t>this.totalLicenses?this.updateSubChangePlan(e.length+t,{emails:e,numProvisionedLicenses:t,totalLicenses:this.totalLicenses},{isLoading:!1}):this.setState({isLoading:!1})},a.prototype.updateSubChangePlan=function(e,t,n){var s=this;void 0===n&&(n={});var a=b.SubscriptionDiff.fromSubscriptionStatus(this.state.subStatus);a.setTotalLicenses(e),this.setState({isMakingTransitionInfoRequest:!0},(function(){var e=Date.now();s.subService.price(a).then((function(a){var o=t.emails,r=t.totalLicenses,l=t.numProvisionedLicenses;s.onSubServiceResponse(a,o,r,l),P.isEmpty(n)||s.setState(n),m.TeamsWebActionsLogger.log("invite_member_billing_load_time_new_imm",i.__assign(i.__assign({},s.defaultLoggingExtras),{time_ms:Date.now()-e}))}))}))},Object.defineProperty(a.prototype,"shouldRenderSendInviteAction",{get:function(){return this.state.isEmailTextInputted},enumerable:!0,configurable:!0}),a.prototype.renderAltAction=function(e){var t=this.state.numRemainingLicenses;return!this.isNCCT&&t&&t<0?this.renderPricingInformation():null},a.prototype.renderForm=function(){var e=this.state,t=e.inviteMessage,i=e.isLoading,s=e.isEmailTextInputted,a=this.props,o=a.isInviteLinkGaEnabled,r=a.shouldShowInviteLink,l=!o||s;return n.default.createElement("form",{className:"invite-modal__form"},r&&n.default.createElement("p",{className:"invite-modal__form_title"},C.intl.formatMessage({id:"1OLWiG",defaultMessage:"Or invite with an email"})),this.renderContactsTokenizer(this.viewer.work_user),l&&n.default.createElement("div",null,n.default.createElement("textarea",{className:"invite-modal__message-input",disabled:i,id:"message-input",onChange:this.onMessageChanged,placeholder:C.intl.formatMessage({id:"D4+6Xw",defaultMessage:"Add an optional message"}),value:t}),n.default.createElement("label",{className:"message-input-label",htmlFor:"message-input"},C.intl.formatMessage({id:"N6BsJQ",defaultMessage:"Invite message"}))))},a.prototype.renderLicensesRemainingText=function(){var e,t=this.state,i=t.emails,s=t.isLoading,a=t.isReseller,o=t.numRemainingLicenses,r=t.resellerContact,l=t.isSelfServe,m=i.length,c=this.props.isInviteLinkGaEnabled;if(s)return n.default.createElement(u.LoadingIndicator,{className:"loading-indicator__licenses",style:u.LoadingIndicator.LoadingIndicatorStyle.SPINNER});if(this.isNCCT)return null;if(0===m)return 0===o?(e=C.intl.formatMessage({id:"Jdo+KG",defaultMessage:"You have no remaining licenses."}),c&&(e=C.intl.formatMessage({id:"ztOAKn",defaultMessage:"You have no licenses available"}))):(e=C.intl.formatMessage({id:"kPEGPd",defaultMessage:"{count, plural, one{You have {count} remaining license.} other{You have {count} remaining licenses.}}"},{count:o}),c&&(e=C.intl.formatMessage({id:"1wqEdn",defaultMessage:"{count, plural, one{You have {count} available license.} other{You have {count} available licenses.}}"},{count:o}))),e;if(o<0)return e=a&&r?r.name&&r.phone?C.intl.formatMessage({id:"MahXPc",defaultMessage:"{count, plural, one{You need more licenses for this invitation. Contact {name} at {phone} to add more.} other{You need more licenses for these invitations. Contact {name} at {phone} to add more.}}"},{count:m,name:r.name,phone:r.phone}):C.intl.formatMessage({id:"MeCUMG",defaultMessage:"{count, plural, one{You need more licenses for this invitation. Contact your reseller to add more.} other{You need more licenses for these invitations. Contact your reseller to add more.}}"},{count:m}):l?C.intl.formatMessage({id:"bSWJau",defaultMessage:"{count, plural, one{You need more licenses for this invitation.} other{You need more licenses for these invitations.}}"},{count:m}):C.intl.formatMessage({id:"PYe+Gn",defaultMessage:"{count, plural, one{You need more licenses for this invitation. Please contact your account executive to purchase licenses.} other{You need more licenses for these invitations. Please contact your account executive to purchase licenses.}}"},{count:m});var d=C.intl.formatMessage({id:"TyEk+t",defaultMessage:"{count, plural, one{After this invitation} other{After these invitations}}"},{count:m});return e=0===o?C.intl.formatMessage({id:"WOvbOS",defaultMessage:"{invitation_msg}, you’ll have no remaining licenses."},{invitation_msg:d}):C.intl.formatMessage({id:"gTZ9A1",defaultMessage:"{count, plural, one{{invitation_msg}, you’ll have {count} remaining license.} other{{invitation_msg}, you’ll have {count} remaining licenses.}}"},{invitation_msg:d,count:o})},a.prototype.renderPricingInformation=function(){var e=this.state,t=e.numRemainingLicenses,i=e.subChangePlan,s=e.subStatus,a=e.isMakingTransitionInfoRequest;return s&&i&&i.finalSubState.billingSchedule?a?n.default.createElement("div",{className:"invite-modal__invite-and-buy"},n.default.createElement(u.LoadingIndicator,{style:u.LoadingIndicator.LoadingIndicatorStyle.SPINNER})):i.tvm?n.default.createElement("div",{className:"invite-modal__invite-and-buy"},n.default.createElement(I.InviteAndBuyText,{className:"invite-modal__invite-and-buy-text u-font-meta",additionalLicenses:-1*t,isTrial:s.isOnTrial,nextBillingDate:s.formattedNextBillingDate,subChangePlan:i}),n.default.createElement("a",{href:"#",className:"invite-modal__update-billing-link",onClick:this.onBillingClick},C.intl.formatMessage({id:"tbFeQQ",defaultMessage:"Update billing"}))):null:null},Object.defineProperty(a.prototype,"isNCCT",{get:function(){var e=this.state.subStatus;return!!e&&(e.isOnTrial&&A.Experiment(this.props.ncctVariant).variantIn("V1","V2","V3","V4","V5","V6","V7","V8","V9","V10","V11","V12","V13"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"growthActSmbFirstTask",{get:function(){return A.Experiment(this.props.experiments.growthActSmbFirstTask)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"growthActSmbGroupsIMM",{get:function(){return A.Experiment(this.props.experiments.growthActSmbGroupsIMM)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"growthActSmbMWInvites",{get:function(){return A.Experiment(this.props.experiments.growthActSmbMWInvites)},enumerable:!0,configurable:!0}),a.prototype.sendGroupInvites=function(e,t){this.setState({emails:e,groupIds:t},this.sendMemberInvites)},a.prototype.render=function(){var e=this,t=this.props,i=t.isOpen,s=t.customClass,a=t.shouldShowInviteLink,r=t.inviteLinkUrl,l=t.inviteLinkExpiredTs,m=t.inviteToken,u=t.isInviteLinkGaEnabled,c=t.enableInviteLinkCopyOnCreate,d=t.nextInviteLinkUrl,g=t.csvImportLabel,v=t.onCSVImport,p=t.tieredAdmin,_=t.width,f=void 0===_?699:_,b=t.ncctNoBillingInfo,h=t.isInviteLinkEnabled,M=this.state,S=M.numRemainingLicenses,L=M.emails,I=M.isSubmitting,y=M.memberList,A=M.showSidebar,E=M.sentEmails,w=M.memberActionsData,T=C.intl.formatMessage({id:"nvkATX",defaultMessage:"Invite members to your team"}),x=this.shouldRenderSendInviteAction||!u;if(this.growthActSmbGroupsIMM.isActive)return n.default.createElement(W.GroupsInviteModal,{open:!!i,isSubmitting:I,memberList:y,handleOnClose:this.closeModal,handleCSVImport:this.closeAndOpenCSVImportModal,sendInvites:function(t,i){return e.sendGroupInvites(t,i)}});if(this.growthActSmbFirstTask.isActive&&y.length){var N=this.growthActSmbMWInvites.isActive?"invite-modal-first-task-mobile":"invite-modal-first-task",R=n.default.createRef(),D=k.Viewer.get_viewer();return n.default.createElement(V.FirstTaskInviteModal,{currentUserId:D.work_user.id,open:!!i,baseClass:N,showSidebar:A,tieredAdmin:p,memberList:y,memberActionsData:w,emails:L,focusRef:R,sentEmails:E,handleOnClose:this.closeModal,loggingExtras:this.defaultLoggingExtras,growthActSmbMWInvitesActive:this.growthActSmbMWInvites.isActive,isInviteLinkEnabled:h,teamId:D.team_id,teamName:D.team_name},this.growthActSmbMWInvites.isActive?n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:N+"__invite-form"},this.renderContactsTokenizer(this.viewer.work_user,C.intl.formatMessage({id:"UOL9zS",defaultMessage:"Email addresses"}),5),this.renderPrimaryAction(this.onPrimaryActionClick,R))):n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:N+"__subtitle"},n.default.createElement("div",null,C.intl.formatMessage({id:"5wXHv3",defaultMessage:"Invite by email"})),!1),n.default.createElement("div",{className:N+"__invite-form"},this.renderContactsTokenizer(this.viewer.work_user,C.intl.formatMessage({id:"UOL9zS",defaultMessage:"Email addresses"}),5),this.renderPrimaryAction(this.onPrimaryActionClick,R))))}return n.default.createElement(o.UtilityModal,{ariaLabel:C.intl.formatMessage({id:"TuViF7",defaultMessage:"Invite Members"}),className:"invite-modal "+s,onPrimaryAction:this.onPrimaryActionClick,onSecondaryAction:this.onSecondaryActionClick,open:!0,overlayClickClose:!0,primaryAction:this.renderPrimaryAction,secondaryAction:x?this.renderSecondaryAction:void 0,title:T,width:f+"px",link:g,onLink:v?this.closeAndOpenCSVImportModal:void 0,overlayClassName:"file-viewer-modal-overlay"},n.default.createElement(O.UXAnalyticsModalTracking,{id:"invite-modal"}),n.default.createElement("div",{className:"invite-modal__content"},n.default.createElement("p",{id:"invite-modal__form-license-msg"},this.renderLicensesRemainingText()),a&&n.default.createElement(F.InviteLink,{numRemainingLicenses:S,inviteLinkUrl:r,inviteLinkExpiredTs:l,inviteToken:m,teamRoutes:this.apiClient.teamRoutes(),emails:L,onInviteLinkCreate:this.props.onInviteLinkCreate,onInviteLinkDelete:this.props.onInviteLinkDelete,onUpdateModal:this.props.onUpdateModal,isTrial:P.get(this.state.subStatus,"isOnTrial"),showAddLicenses:this.props.showAddLicenses,isLoadingNumRemainingLicenses:this.state.isLoading,isNcct:this.isNCCT&&(null==b||b),isInviteLinkGaEnabled:u,enableInviteLinkCopyOnCreate:c,nextInviteLinkUrl:d}),this.renderForm(),this.renderAltAction()))},a.defaultProps={experiments:{growthActSmbFirstTask:"OFF",growthActSmbGroupsIMM:"OFF",growthActSmbMWInvites:"OFF"},inviteMessage:"",emails:[]},a})(n.default.Component);t.InviteModalView=Y,t.InviteModal=L.requireCssWithComponent(Y,["/static/css/spectrum/index.web-vflTq87Ea.css","/static/js/spectrum-sharing/index.web-vfl3v3vHU.css","/static/css/teams/admin/widgets/invite_modal/invite_modal-vfltjewl3.css"])}));
//# sourceMappingURL=invite_modal.min.js-vflL3imxd.map