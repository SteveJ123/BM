define(["require","exports","tslib","react","classnames","modules/clean/react/file_activity_stream/updating_time_ago_with_details","modules/clean/react/file_activity_stream/utils","modules/clean/react/file_activity_stream/file_activity_stream_card_detail","modules/core/i18n"],(function(e,t,a,i,n,r,l,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importDefault(i),n=a.__importDefault(n),t.HEADER_MESSAGE_CLASS_NAME="file_activity_stream_card__header";var d=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.onActionClick=function(e){var a,i;e.stopPropagation(),null===(i=null===(a=e.nativeEvent)||void 0===a?void 0:a.stopImmediatePropagation)||void 0===i||i.call(a),t.props.action&&t.props.action.onClick()},t}return a.__extends(n,e),n.prototype.render=function(){var e=this.props,a=e.action,n=e.message,s=e.timestamp,o=e.user,d=e.thirdpartyData,c=d&&d.localizedName&&d.logoUrl,m=i.default.createElement("div",{className:"file_activity_stream_card__metadata"},i.default.createElement(r.UpdatingTimeAgoWithDetails,{timestamp:s}),a&&i.default.createElement("span",{className:"file_activity_stream_card__action"}," •  ",i.default.createElement("button",{onClick:this.onActionClick},a.text)),!a&&c&&i.default.createElement("span",null," •  ",d.localizedName));return i.default.createElement("div",{className:"file_activity_stream_card__inner"},i.default.createElement("div",{className:"file_activity_stream_card__avatar_wrapper"},i.default.createElement("div",{className:"file_activity_stream_card__avatar"},l.renderAvatar(o)),c&&i.default.createElement("div",{className:"file_activity_stream_card__thirdparty_logo"},i.default.createElement("img",{className:"file_activity_stream_card__thirdparty_logo_image",src:d.logoUrl,alt:d.localizedName}))),i.default.createElement("div",null,i.default.createElement("div",{className:t.HEADER_MESSAGE_CLASS_NAME},n),m))},n})(i.default.PureComponent),c=(function(e){function t(t){var a=e.call(this,t)||this;return a.detailChildren=[],a.expand=function(){document.addEventListener("click",a.close),a.setState({isExpanded:!0})},a.close=function(){a.isExpandable&&a.state.isExpanded&&a.setState({isExpanded:!1}),document.removeEventListener("click",a.close)},a.handleClick=function(e){var t,i,n,r;e.preventDefault(),null===(i=null===(t=e.nativeEvent)||void 0===t?void 0:t.preventDefault)||void 0===i||i.call(t),a.isExpandable&&(a.state.isExpanded?(e.stopPropagation(),null===(r=null===(n=e.nativeEvent)||void 0===n?void 0:n.stopImmediatePropagation)||void 0===r||r.call(n)):a.expand())},a.handleKeyDown=function(e){a.isExpandable&&!a.state.isExpanded&&13===e.which&&a.expand()},a.incrementMaxShownOnOpen=function(){a.setState({maxShownOnOpen:a.state.maxShownOnOpen+10})},a.state={isExpanded:!1,maxShownOnOpen:10},a}return a.__extends(t,e),Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.componentWillMount=function(){this.detailChildren=l.extractChildrenOfType(this.props.children,s.FileActivityStreamCardDetail)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.close)},t.prototype.componentWillReceiveProps=function(e){var t=e.children;this.detailChildren=l.extractChildrenOfType(t,s.FileActivityStreamCardDetail)},t.prototype.renderDetails=function(){if(!this.state.isExpanded)return null;var e=this.detailChildren.slice(0,this.state.maxShownOnOpen);return this.props.onExpand&&this.props.onExpand(),i.default.Children.map(e,(function(e){return e}))},t.prototype.renderShowMore=function(){if(!this.state.isExpanded||this.state.maxShownOnOpen>=this.detailChildren.length)return null;var e=Math.min(10,this.detailChildren.length-this.state.maxShownOnOpen),t=o.intl.formatMessage({id:"chNbcV",defaultMessage:"Show {num_more} more"},{num_more:e});return i.default.createElement("button",{className:"show_more",onClick:this.incrementMaxShownOnOpen},t)},t.prototype.render=function(){var e=this.props,t=e.action,a=e.className,r=e.message,l=e.timestamp,s=e.user,o=e.thirdPartyData,c=this.state.isExpanded;return i.default.createElement("div",{className:n.default(a,{file_activity_stream_card:!0,"file_activity_stream_card-has_action":!!t,"file_activity_stream_card-is_expandable":this.isExpandable,"file_activity_stream_card-is_expanded":c}),onClick:this.handleClick,onKeyDown:this.handleKeyDown,tabIndex:0},i.default.createElement(d,{action:t,message:r,timestamp:l,user:s,thirdpartyData:o}),this.renderDetails(),this.renderShowMore())},t.Detail=s.FileActivityStreamCardDetail,t})(i.default.Component);t.FileActivityStreamCard=c}));
//# sourceMappingURL=file_activity_stream_card.min.js-vflC03SKF.map